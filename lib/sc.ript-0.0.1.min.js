(function(){var t,i,n,e,r,o,s,h,u,a,l,c,p,f,_,d,y,x,m,g,v,w,M,E,b,I,P,R,T,B,O,L,C=[].slice,S={}.hasOwnProperty,D=function(t,i){function n(){this.constructor=t}for(var e in i)S.call(i,e)&&(t[e]=i[e]);return n.prototype=i.prototype,t.prototype=new n,t.__super__=i.prototype,t},A=function(t,i){return function(){return t.apply(i,arguments)}};u=function(){function t(){}return t.toCSSString=function(t,i){var n,e,r;return null==i&&(i=1),r=255&t>>16,e=255&t>>8,n=255&t,i=0>i?0:i>1?1:i,1===i?"rgb("+r+","+e+","+n+")":"rgba("+r+","+e+","+n+","+i+")"},t.average=function(){var t,i,n;return t=arguments.length>=1?C.call(arguments,0):[],n=function(){var i,n,e,r;for(r=[],n=0,e=t.length;e>n;n++)i=t[n],r.push(new b(i));return r}(),i=b.average.apply(null,n),i.toHex()},t}(),h=function(){function t(){}return t.NONE="butt",t.BUTT="butt",t.ROUND="round",t.SQUARE="square",t}(),c=function(){function t(){this.x=this.y=this.rotation=0,this.scaleX=this.scaleY=1,this.blendMode=e.NORMAL}return t._RADIAN_PER_DEGREE=Math.PI/180,t.prototype.matrix=function(){return(new v).scale(this.scaleX,this.scaleY).rotate(this.rotation*t._RADIAN_PER_DEGREE).translate(this.x,this.y)},t}(),y=function(){function t(){}return t.NO_OP=0,t.MOVE_TO=1,t.LINE_TO=2,t.CURVE_TO=3,t.WIDE_MOVE_TO=4,t.WIDE_LINE_TO=5,t.CUBIC_CURVE_TO=6,t}(),m=function(){function t(){}return t.BEVEL="bevel",t.MITER="miter",t.ROUND="round",t}(),e=function(){function t(){}return t.NORMAL="normal",t.BLEND="blend",t.ADD="add",t.SUBTRACT="subtract",t.DARKEST="darkest",t.LIGHTEST="lightest",t.DIFFERENCE="difference",t.EXCLUSION="exclusion",t.MULTIPLY="multiply",t.SCREEN="screen",t.OVERLAY="overlay",t.SOFT_LIGHT="softLight",t.HARD_LIGHT="hardLight",t.VIVID_LIGHT="vividLight",t.LINEAR_LIGHT="linearLight",t.PIN_LIGHT="pinLight",t.HARD_MIX="hardMix",t.DODGE="dodge",t.BURN="burn",t.LINEAR_DODGE="linearDodge",t.LINEAR_BURN="linearBurn",t.PUNCH="punch",t.MASK="mask",t}(),f=function(){function t(){this._receivers={}}return t.prototype.on=function(t,i,n,e){var r,o,s;if(null==n&&(n=!1),null==e&&(e=0),"function"!=typeof i)throw new TypeError("listener is't Function");for(null==this._receivers[t]&&(this._receivers[t]=[]),s=this._receivers[t],r=s.length;r--;)if(o=reveicers[r],o.listener===i)return this;return s.push({listener:i,useCapture:n,priority:e}),s.sort(function(t,i){return i.priority-t.priority}),this},t.prototype.off=function(t,i){var n,e;if(e=this._receivers[t],!e)return this;for(n=e.length;n--;)e[n].listener===i&&e.splice(n,1),0===e.length&&delete this._receivers[t];return this},t.prototype.emit=function(t){var i,n,e,r,o,s=this;if(n=this._receivers[t.type],null==n)return this;for(t.currentTarget=this,e=function(i){return setTimeout(function(){return t._isPropagationStoppedImmediately?void 0:i.listener.call(s,t)},0)},r=0,o=n.length;o>r;r++)i=n[r],e(i);return this},t}(),s=function(){function t(){}return t.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,t.fromDataURL=function(t){var i,n,e,r,o,s,h,u;for(s=t.split(",")[0].split(":")[1].split(";")[0],e=atob(t.split(",")[1]),i=new ArrayBuffer(e.length),o=new Uint8Array(i),r=h=0,u=e.length;u>h;r=h+=1)o[r]=e.charCodeAt(r);return null!=this.BlobBuilder?(n=new this.BlobBuilder,n.append(o.buffer),n.getBlob(s)):null!=window.Blob?new Blob([i],{type:s}):void 0},t}(),x=function(){function t(t,i,n){var e,r,o,s,h,u,a,l;this.h=t,this.s=i,this.v=n,1===arguments.length&&(s=t,u=new b(s),h=u.r/255,o=u.g/255,e=u.b/255,t=i=n=0,a=h>=o?h:o,e>a&&(a=e),l=o>=h?h:o,l>e&&(l=e),n=a,r=a-l,i=0===a?0:r/a,0!==i&&(h===a?t=(o-e)/r:o===a?t=2+(e-h)/r:e===a&&(t=4+(h-o)/r),t=60*t,0>t&&(t+=360)),this.h=t,this.s=i,this.v=n),this.normalize()}return t.prototype.normalize=function(){return this.s=0>this.s?0:this.s>1?1:this.s,this.v=0>this.v?0:this.v>1?1:this.v,this.h=this.h%360,0>this.h?this.h+=360:void 0},t.prototype.toRGB=function(){var t,i,n,e,r,o,s;switch(this.normalize(),t=this.h,n=this.s,e=this.v,t/=60,i=t>>0,r=e*(1-n),o=e*(1-n*(t-1)),s=e*(1-n*(1-t+i)),r=255*r>>0,o=255*o>>0,s=255*s>>0,e=255*e>>0,i){case 0:return new b(e,s,r);case 1:return new b(o,e,r);case 2:return new b(r,e,s);case 3:return new b(r,o,e);case 4:return new b(s,r,e);case 5:return new b(e,r,o)}},t.prototype.toHex=function(){return this.toRGB().toHex()},t}(),E=function(){function t(){}return t.stringify=function(t,i,n){var e,r,o;null==i&&(i="&"),null==n&&(n="="),r=[];for(e in t)o=t[e],r.push(""+e+n+o);return r.join(i)},t}(),_=function(){function t(t){this.quality=null!=t?t:1}return t.prototype.run=function(t){var i,n,e,r,o,s,h,u,a,l,c,p;for(h=t.width,n=t.height,i=t.data,o=[],e=0,a=l=0;n>l;a=l+=1)for(o[a]=[],u=c=0;h>c;u=c+=1)o[a][u]=[i[e],i[e+1],i[e+2],i[e+3]],e+=4;for(s=this.quality,p=[];s--;)e=0,p.push(function(){var t,s;for(s=[],a=t=0;n>t;a=t+=1)s.push(function(){var t,s;for(s=[],u=t=0;h>t;u=t+=1)r=o[a][u]=this._evaluatePixel(o,u,a,h,n),i[e]=r[0],i[e+1]=r[1],i[e+2]=r[2],i[e+3]=r[3],s.push(e+=4);return s}.call(this));return s}.call(this));return p},t.prototype._evaluatePixel=function(t,i,n){return t[n][i]},t.prototype._getPixel=function(t,i,n,e,r){return i=0>i?0:i>e-1?e-1:i,n=0>n?0:n>r-1?r-1:n,t[n][i]},t}(),n=function(){function t(){}return t._mix=function(t,i,n){return t+((i-t)*n>>8)},t._peg=function(t){return 0>t?0:t>255?255:t},t.scan=function(i,n,e){var r,o,s,h,u,a,l;if(i=t[i],null==i)throw new TypeError(""+i+" isn't defined.");for(h=n.data,r=e.data,o=u=0,a=r.length;a>u;o=u+=4)s=i(r[o],r[o+1],r[o+2],r[o+3],h[o],h[o+1],h[o+2],h[o+3]),[].splice.apply(r,[o,o+3-o+1].concat(l=s.slice(0,4))),l;return e},t.blend=function(i,n,e,r,o,s,h,u){return[t._mix(i,o,u),t._mix(n,s,u),t._mix(e,h,u),r+u]},t.add=function(t,i,n,e,r,o,s,h){return[t+(r*h>>8),i+(o*h>>8),n+(s*h>>8),e+h]},t.subtract=function(t,i,n,e,r,o,s,h){return[t-(r*h>>8),i-(o*h>>8),n-(s*h>>8),e+h]},t.darkest=function(i,n,e,r,o,s,h,u){return[t._mix(i,Math.min(i,o*u>>8),u),t._mix(n,Math.min(n,s*u>>8),u),t._mix(e,Math.min(e,h*u>>8),u),r+u]},t.lightest=function(t,i,n,e,r,o,s,h){return[Math.max(t,r*h>>8),Math.max(i,o*h>>8),Math.max(n,s*h>>8),e+h]},t.difference=function(i,n,e,r,o,s,h,u){return[t._mix(i,i>o?i-o:o-i,u),t._mix(n,n>s?n-s:s-n,u),t._mix(e,e>h?e-h:h-e,u),r+u]},t.exclusion=function(i,n,e,r,o,s,h,u){return[t._mix(i,i+o-(i*o>>7),u),t._mix(n,n+s-(n*s>>7),u),t._mix(e,e+h-(e*h>>7),u),r+u]},t.reflex=function(i,n,e,r,o,s,h,u){return[t._mix(i,255===o?o:i*i/(255-o),u),t._mix(n,255===s?s:n*n/(255-s),u),t._mix(e,255===h?h:e*e/(255-h),u),r+u]},t.multiply=function(i,n,e,r,o,s,h,u){return[t._mix(i,i*o>>8,u),t._mix(n,n*s>>8,u),t._mix(e,e*h>>8,u),r+u]},t.screen=function(i,n,e,r,o,s,h,u){return[t._mix(i,255-((255-i)*(255-o)>>8),u),t._mix(n,255-((255-n)*(255-s)>>8),u),t._mix(e,255-((255-e)*(255-h)>>8),u),r+u]},t.overlay=function(i,n,e,r,o,s,h,u){return[t._mix(i,128>i?i*o>>7:255-((255-i)*(255-o)>>7),u),t._mix(n,128>n?n*s>>7:255-((255-n)*(255-s)>>7),u),t._mix(e,128>e?e*h>>7:255-((255-e)*(255-h)>>7),u),r+u]},t.softLight=function(i,n,e,r,o,s,h,u){return[t._mix(i,(i*o>>7)+(i*i>>8)-(i*i*o>>15),u),t._mix(n,(n*s>>7)+(n*n>>8)-(n*n*s>>15),u),t._mix(e,(e*h>>7)+(e*e>>8)-(e*e*h>>15),u),r+u]},t.hardLight=function(i,n,e,r,o,s,h,u){return[t._mix(i,128>o?i*o>>7:255-((255-i)*(255-o)>>7),u),t._mix(n,128>s?n*s>>7:255-((255-n)*(255-s)>>7),u),t._mix(e,128>h?e*h>>7:255-((255-e)*(255-h)>>7),u),r+u]},t.vividLight=function(i,n,e,r,o,s,h,u){return[0===o?0:255===o?255:128>o?255-t._peg((255-i<<8)/(2*o)):t._peg((i<<8)/(2*(255-o))),0===s?0:255===s?255:128>s?255-t._peg((255-n<<8)/(2*s)):t._peg((n<<8)/(2*(255-s))),0===h?0:255===h?255:128>h?255-t._peg((255-e<<8)/(2*h)):t._peg((e<<8)/(2*(255-h))),r+u]},t.linearLight=function(t,i,n,e,r,o,s,h){return[128>r?Math.max(2*r+t-255,0):Math.min(r+t,255),128>o?Math.max(2*o+i-255,0):Math.min(o+i,255),128>s?Math.max(2*s+n-255,0):Math.min(s+n,255),e+h]},t.pinLight=function(t,i,n,e,r,o,s,h){return[128>r?Math.min(2*r,t):Math.max(2*(r-128),t),128>o?Math.min(2*o,i):Math.max(2*(o-128),i),128>s?Math.min(2*s,n):Math.max(2*(s-128),n),e+h]},t.hardMix=function(i,n,e,r,o,s,h,u){var a,l,c;return c=0===o?0:255===o?255:128>o?255-t._peg((255-i<<8)/(2*o)):t._peg((i<<8)/(2*(255-o))),l=0===s?0:255===s?255:128>s?255-t._peg((255-n<<8)/(2*s)):t._peg((n<<8)/(2*(255-s))),a=0===h?0:255===h?255:128>h?255-t._peg((255-e<<8)/(2*h)):t._peg((e<<8)/(2*(255-h))),[128>c?0:255,128>l?0:255,128>a?0:255,r+u]},t.dodge=function(i,n,e,r,o,s,h,u){return[t._mix(i,t._peg((i<<8)/(255-o)),u),t._mix(n,t._peg((n<<8)/(255-s)),u),t._mix(e,t._peg((e<<8)/(255-h)),u),r+u]},t.burn=function(i,n,e,r,o,s,h,u){return[t._mix(i,0===o?0:255-t._peg((255-i<<8)/o),u),t._mix(n,0===s?0:255-t._peg((255-n<<8)/s),u),t._mix(e,0===h?0:255-t._peg((255-e<<8)/h),u),r+u]},t.linearDodge=function(i,n,e,r,o,s,h,u){return[t._mix(i,Math.min(o+i,255),u),t._mix(n,Math.min(n+s,255),u),t._mix(e,Math.min(e+h,255),u),r+u]},t.linearBurn=function(i,n,e,r,o,s,h,u){return[t._mix(i,Math.max(o+i-255,0),u),t._mix(n,Math.max(n+s-255,0),u),t._mix(e,Math.max(e+h-255,0),u),r+u]},t.punch=function(i,n,e,r,o,s,h,u){return[i,n,e,r*t._peg(255-u)/255]},t.mask=function(t,i,n,e,r,o,s,h){return[t,i,n,e*h/255]},t}(),B=function(){function t(){}return t.join=function(){var i,n,e,r,o;for(e=arguments.length>=1?C.call(arguments,0):[],e=e.join("/").replace(/\/{2,}/g,"/").split("/"),n=[],r=0,o=e.length;o>r;r++)switch(t=e[r]){case".":break;case"..":i=n[n.length-1],null!=i&&".."!==i?n.pop():n.push(t);break;default:n.push(t)}return n.join("/")},t}(),w=function(){function t(){}return t.RADIAN_PER_DEGREE=Math.PI/180,t.DEGREE_PER_RADIAN=180/Math.PI,t.KB=1024,t.MB=t.KB*t.KB,t.GB=t.MB*t.KB,t.TB=t.GB*t.KB,t.degree=function(t){return t*this.DEGREE_PER_RADIAN},t.radian=function(t){return t*this.RADIAN_PER_DEGREE},t.signify=function(t,i){var n;return n=Math.pow(10,i),(t*n>>0)/n},t.kb=function(t){return t/this.KB},t.mb=function(t){return t/this.MB},t.gb=function(t){return t/this.GB},t.random=function(t,i){return t+(i-t)*Math.random()},t}(),I=function(){function t(t,i,n,e){this.x=null!=t?t:0,this.y=null!=i?i:0,this.width=null!=n?n:0,this.height=null!=e?e:0}return t.prototype.toString=function(){return"[Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},t.prototype.clone=function(){return new t(this.x,this.y,this.width,this.height)},t.prototype.apply=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},t.prototype.contains=function(t,i){return t>this.x&&this.x+this.width>t&&i>this.y&&this.y+this.height>i},t.prototype.containsPoint=function(t){var i,n;return this.x<(i=t.x)&&this.x+this.width>i&&this.y<(n=t.y)&&this.y+this.height>n},t.prototype.contain=function(t,i){return this.x>t?(this.width+=this.x-t,this.x=t):t>this.x+this.width&&(this.width=t-this.x),this.y>i?(this.height+=this.y-i,this.y=i):i>this.y+this.height&&(this.height=i-this.y),this},t.prototype.offset=function(t,i){return this.x+=t,this.y+=i,this},t.prototype.offsetPoint=function(t){return this.x+=t.x,this.y+=t.y,this},t.prototype.inflate=function(t,i){return this.width+=t,this.height+=i,this},t.prototype.inflatePoint=function(t){return this.width+=t.x,this.height+=t.y,this},t.prototype.deflate=function(t,i){return this.width-=t,this.height-=i,this},t.prototype.deflatePoint=function(t){return this.width-=t.x,this.height-=t.y,this},t.prototype.union=function(t){var i,n,e,r,o,s,h,u,a,l;return o=this.x<t.x?this.x:t.x,h=this.x+this.width,u=t.x+t.width,s=h>u?h:u,l=s-o,a=this.y<t.y?this.y:t.y,n=this.y+this.height,e=t.y+t.height,i=n>e?n:e,r=i-a,this.x=o,this.y=a,this.width=0>l?0:l,this.height=0>r?0:r,this},t.prototype.isEmpty=function(){return 0===this.x&&0===this.y&&0===this.width&&0===this.height},t.prototype.intersects=function(t){var i,n,e,r,o,s;return e=_max(this.x,t.x),r=_min(this.x+this.width,t.x+t.width),s=r-e,0>=s?!1:(o=_max(this.y,t.y),i=_min(this.y+this.height,t.y+t.height),n=i-o,0>=n?!1:!0)},t.prototype.intersection=function(i){var n,e,r,o,s,h;return r=_max(this.x,i.x),o=_min(this.x+this.width,i.x+i.width),h=o-r,0>=h?new t:(s=_max(this.y,i.y),n=_min(this.y+this.height,i.y+i.height),e=n-s,0>=e?new t:new t(r,s,h,e))},t.prototype.measureFarDistance=function(t,i){var n,e,r,o,s,h,u,a,l;return h=this.x,a=this.x+this.width,l=this.y,n=this.y+this.height,r=t-h,o=t-a,s=i-l,e=i-n,r*=r,o*=o,s*=s,e*=e,u=_max(r+s,o+s,o+e,r+e),_sqrt(u)},t.prototype.adjustOuter=function(){var t,i;return t=Math.floor(this.x),i=Math.floor(this.y),t!==this.x&&this.width++,i!==this.y&&this.height++,this.x=t,this.y=i,this.width=Math.ceil(this.width),this.height=Math.ceil(this.height),this},t.prototype.transform=function(t){var i,n,e,r,o,s,h,u;return r=new v(1,0,0,1,this.x,this.y),h=new v(1,0,0,1,this.x+this.width,this.y),s=new v(1,0,0,1,this.x+this.width,this.y+this.height),e=new v(1,0,0,1,this.x,this.y+this.height),r.concat(t),h.concat(t),s.concat(t),e.concat(t),n=_min(r.ox,h.ox,s.ox,e.ox),o=_max(r.ox,h.ox,s.ox,e.ox),u=_min(r.oy,h.oy,s.oy,e.oy),i=_max(r.oy,h.oy,s.oy,e.oy),this.x=n,this.y=u,this.width=o-n,this.height=i-u,this},t}(),l=function(){function t(){}return t.loadData=function(t,i,n){var e,r,o;if(null==i&&(i="get"),null==n&&(n=""),e=new Deferred,null!=window.ActiveXObject)try{o=new ActiveXObject("Msxml2.XMLHTTP")}catch(s){r=s;try{o=new ActiveXObject("Microsoft.XMLHTTP")}catch(s){throw r=s,new TypeError("doesn't support XMLHttpRequest")}}else{if(!window.XMLHttpRequest)throw new TypeError("doesn't support XMLHttpRequest");o=new XMLHttpRequest}return o.onerror=function(t){return e.fail(t)},o.onreadystatechange=function(){return 4===o.readyState?e.call(o.responseText):void 0},o.open(i,t,!0),o.send(n),e},t.loadImage=function(t){var i,n;return i=new Deferred,n=new Image,n.onerror=function(t){return i.fail(t)},n.onload=function(){return i.call(n)},n.src=t,i},t.loadFile=function(t){var i,n;return i=new Deferred,n=new FileReader,n.onerror=function(t){return i.fail(t)},n.onload=function(){return i.call(n.result)},n.readAsDataURL(t),i},t}(),M=function(){function t(t,i){null==t&&(t=0),null==i&&(i=0),this.x=+t,this.y=+i}return t.equals=function(t,i){return t.equals(i)},t.dotProduct=function(t,i){return t.x*i.x+t.y*i.y},t.angle=function(t,i){return i.subtract(t).angle()},t.distance=function(t,i){return i.subtract(t).length()},t.interpolate=function(t,i,n){return t.add(i.subtract(t).multiply(n))},t.inflate=function(t,i,n){var e,r,o,s;return r=t.x-i.x,o=t.y-i.y,e=Math.sqrt(r*r+o*o),s=1+n/e,this.interpolate(t,i,s)},t.prototype.angle=function(t){var i;return null==t?Math.atan2(this.y,this.x):(i=this.length(),this.x=i*Math.cos(t),this.y=i*Math.sin(t))},t.prototype.length=function(t){var i;return null==t?Math.sqrt(this.x*this.x+this.y*this.y):(i=this.angle(),this.x=t*Math.cos(i),this.y=t*Math.sin(i))},t.prototype.clone=function(){return new t(this.x,this.y)},t.prototype.equals=function(t){return this.x===t.x&&this.y===t.y},t.prototype.add=function(i){return new t(this.x+i.x,this.y+i.y)},t.prototype.subtract=function(i){return new t(this.x-i.x,this.y-i.y)},t.prototype.multiply=function(i){return new t(this.x*i,this.y*i)},t.prototype.divide=function(i){return new t(this.x/i,this.y/i)},t}(),b=function(){function t(t,i,n){var e;this.r=t,this.g=i,this.b=n,1===arguments.length&&(e=t,this.r=255&e>>16,this.g=255&e>>8,this.b=255&e),this.normalize()}return t.average=function(){var i,n,e,r,o,s,h,u;for(s=arguments.length>=1?C.call(arguments,0):[],r=n=i=0,h=0,u=s.length;u>h;h++)o=s[h],r+=o.r,n+=o.g,i+=o.b;return e=s.length,r/=e,n/=e,i/=e,new t(r,n,i)},t.prototype.normalize=function(){return this.r&=255,this.g&=255,this.b&=255},t.prototype.toHex=function(){return this.r<<16|this.g<<8|this.b},t}(),v=function(){function t(t,i,n,e,r,o){this.m11=null!=t?t:1,this.m12=null!=i?i:0,this.m21=null!=n?n:0,this.m22=null!=e?e:1,this.tx=null!=r?r:0,this.ty=null!=o?o:0}return t.prototype.translate=function(i,n){return null==i&&(i=0),null==n&&(n=0),this.concat(new t(1,0,0,1,i,n)),this},t.prototype.scale=function(i,n){return null==i&&(i=1),null==n&&(n=1),this.concat(new t(i,0,0,n,0,0)),this},t.prototype.rotate=function(i){var n,e;return e=Math.sin(i),n=Math.cos(i),this.concat(new t(n,e,-e,n,0,0)),this},t.prototype.concat=function(t){var i,n,e,r,o,s;return i=this.m11,n=this.m12,e=this.m21,r=this.m22,o=this.tx,s=this.ty,this.m11=i*t.m11+n*t.m21,this.m12=i*t.m12+n*t.m22,this.m21=e*t.m11+r*t.m21,this.m22=e*t.m12+r*t.m22,this.tx=o*t.m11+s*t.m21+t.tx,this.ty=o*t.m12+s*t.m22+t.ty,this},t.prototype.invert=function(){var t,i,n,e,r,o,s;return i=this.m11,n=this.m12,e=this.m21,r=this.m22,o=this.tx,s=this.ty,t=i*r-n*e,this.m11=r/t,this.m12=-n/t,this.m21=-e/t,this.m22=i/t,this.m41=(e*s-r*o)/t,this.m42=(n*o-i*s)/t,this},t}(),p=function(){function t(t,i){this.type=t,this.data=i}return t}(),R=function(){function t(){}return t.toString=Object.prototype.toString,t.hasOwnProperty=Object.prototype.hasOwnProperty,t.isElement=function(t){return 1===(null!=t?t.nodeType:void 0)},t.isArray=Array.isArray||function(t){return"[object Array]"===this.toString.call(t)},t.isArguments=function(){var t;return t=function(t){return"[object Arguments]"===this.toString.call(t)},t(arguments)?t:function(t){return null!=t&&this.hasOwnProperty.call(t,"callee")}}(),t.isFunction=function(){return function(t){return typeob("function"===t)}}(),t.isString=function(t){return"[object String]"===this.toString.call(t)},t.isNumber=function(t){return"[object Number]"===this.toString.call(t)},t.isDate=function(t){return"[object Date]"===this.toString.call(t)},t.isRegExp=function(t){return"[object RegExp]"===this.toString.call(t)},t.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},t.isNaN=function(t){return this.isNumber(t)&&t!==+t},t.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===this.toString.call(t)},t.isNull=function(t){return null===t},t.isUndefined=function(t){return null!=t},t.isObject=function(t){return t===Object(t)},t}(),P=function(t){function i(t,n){this.threshold=t,this.operation=n,i.__super__.constructor.call(this)}return D(i,t),i.prototype._evaluatePixel=function(t,i,n){var e,r,o,s,h,u;switch(u=t[n][i],h=u[0],s=u[1],r=u[2],e=u[3],o=e<<24|h<<16|s<<8|r,this.operation){case"<":o=this.threshold>o?o:0;break;case"<=":o=this.threshold>=o?o:0;break;case">":o=o>this.threshold?o:0;break;case">=":o=o>=this.threshold?o:0;break;case"==":o=o===this.threshold?o:0;break;case"!=":o=o!==this.threshold?o:0}return[255&o>>16,255&o>>8,255&o,255&o>>24]},i}(_),g=function(t){function i(t,n,e,r,o){if(i.__super__.constructor.call(this,r),this._radiusX=t,this._radiusY=n,this._width=2*this._radiusX-1,this._height=2*this._radiusY-1,e.length!==this._width*this._height)throw new TypeError("kernel length isn't match with radius");this._applyAlpha=o,this._kernel=e}return D(i,t),i.prototype._evaluatePixel=function(t,i,n,e,r){var o;return o=[0,0,0,0],this._runKernel(o,t,i,n,e,r),this._applyAlpha||(o[3]=t[n][i][3]),o},i.prototype._runKernel=function(t,i,n,e,r,o){var s,h,u,a,l,c,p,f,_,d,y;for(a=0,y=[],p=f=_=1-this._radiusY,d=this._radiusY;d>f;p=f+=1)h=e+p,y.push(function(){var e,p,f,_;for(_=[],c=e=p=1-this._radiusX,f=this._radiusX;f>e;c=e+=1)s=n+c,l=this._getPixel(i,s,h,r,o),u=this._kernel[a],t[0]+=l[0]*u,t[1]+=l[1]*u,t[2]+=l[2]*u,t[3]+=l[3]*u,_.push(a++);return _}.call(this));return y},i}(_),d=function(t){function i(t,n,e){var r,o,s,h,u,a,l,c,p,f,_,d,y;for(null==e&&(e=.84089642),u=2*e*e,l=0,h=[],o=c=_=1-n;n>c;o=c+=1)for(r=p=d=1-t;t>p;r=p+=1)a=1/(u*Math.PI)*Math.exp(-(r*r+o*o)/u),l+=a,h.push(a);for(s=f=0,y=h.length;y>f;s=f+=1)h[s]/=l;i.__super__.constructor.call(this,t,n,h,1,!0)}return D(i,t),i}(g),a=function(t){function i(t){this.matrix=t,i.__super__.constructor.call(this)}return D(i,t),i.prototype._evaluatePixel=function(t,i,n){var e,r,o,s,h,u;return s=this.matrix,u=t[n][i],h=u[0],o=u[1],r=u[2],e=u[3],[h*s[0]+o*s[1]+r*s[2]+e*s[3]+s[4],h*s[5]+o*s[6]+r*s[7]+e*s[8]+s[9],h*s[10]+o*s[11]+r*s[12]+e*s[13]+s[14],h*s[15]+o*s[16]+r*s[17]+e*s[18]+s[19]]},i}(_),o=function(t){function i(t,n,e){var r,o,s,h,u,a,l,c,p,f,_,d,y,x,m;if(this.$elem=t,this.postfixes=n,this.recursive=null!=e?e:!1,this._onClick=A(this._onClick,this),this._onMouseUp=A(this._onMouseUp,this),this._onMouseDown=A(this._onMouseDown,this),this._onMouseOver=A(this._onMouseOver,this),this._onMouseOut=A(this._onMouseOut,this),i.__super__.constructor.call(this),!((null!=(x=this.$elem)?x.length:void 0)>0))throw new TypeError("element isn't exist");null==this.postfixes&&(this.postfixes=i.defaultPostfixes),o="IMG"===this.$elem[0].nodeName?this.$elem:this.recursive?this.$elem.find("img"):this.$elem.children("img"),this._namePartsRegistry={},this._imgs=[],n=[],m=this.postfixes;for(u in m)l=m[u],n.push(l);for(f=0,d=o.length;d>f;f++)if(h=o[f],r=$(h),c=r.attr("src"),null!=c)for(s=_=0,y=n.length;y>_;s=++_)if(l=n[s],null!=l&&(a=c.match(RegExp("^(.*)"+l+"(\\.\\w+)$")),3===(null!=a?a.length:void 0))){this._namePartsRegistry[h]=a,p=n.slice(),p.splice(s,1),this._preload(a,p),this._imgs.push(r);break}this.$elem.on("click",this._onClick).on("mouseleave",this._onMouseOut).on("mouseenter",this._onMouseOver).on("mousedown",this._onMouseDown).on("mouseup",this._onMouseUp),this.enabled(!0)}return D(i,t),i.FULL={out:"_out",over:"_over",down:"_down",disabled:"_disabled"},i.DEFAULT={out:"_out",over:"_over"},i.TOUCH={out:"_out",disabled:"_disabled"},i.defaultPostfixes={out:"_out",over:"_over"},i.prototype.destruct=function(){return this.$elem.off("click",this._onClick).off("mouseleave",this._onMouseOut).off("mouseenter",this._onMouseOver).off("mousedown",this._onMouseDown).off("mouseup",this._onMouseUp),delete this.$elem,delete this.postfixes,delete this.recursive,delete this._enabled,delete this._status,delete this._isMouseOver,delete this._namePartsRegistry,delete this._imgs},i.prototype.enabled=function(t){return null==t?this._enabled:this._enabled===t?this:(t?(this._enabled=t,this.$elem.css("cursor","pointer"),this._onMouseUp()):(this.$elem.css("cursor","default"),this._onMouseOut(),this.status("disabled"),this._enabled=t),this)},i.prototype.status=function(t){var i,n,e,r,o,s,h,u,a;if(null==t)return this._status;if(this._status===t)return this;if(e=this.postfixes[t],null==e)return this;for(this._status=t,u=this._imgs,a=[],s=0,h=u.length;h>s;s++)i=u[s],n=this._namePartsRegistry[i[0]],r=n[1]+e+n[2],o=i[0].vml,o?o.image.fill.setAttribute("src",r):a.push(i.attr("src",r));return a},i.prototype._preload=function(t,i){var n,e,r,o;for(o=[],e=0,r=i.length;r>e;e++)n=i[e],null!=n&&o.push($("<img>").attr("src",t[1]+n+t[2]));return o},i.prototype._onMouseOut=function(t){return this._isMouseOver=!1,this._enabled?(this.status("out"),t?this.emit(t):void 0):void 0},i.prototype._onMouseOver=function(t){return this._isMouseOver=!0,this._enabled?(this.status("over"),t?this.emit(t):void 0):void 0},i.prototype._onMouseDown=function(t){return this._enabled?(this.status("down"),t?this.emit(t):void 0):void 0},i.prototype._onMouseUp=function(t){return this._enabled?(this.status(this._isMouseOver?"over":"out"),t?this.emit(t):void 0):void 0},i.prototype._onClick=function(t){return this._enabled?t?this.emit(t):void 0:void 0},i}(f),t=function(t){function i(t,n,e){var r,o,s,h,u,a,l,c,p;for(null==t&&(t=2),null==n&&(n=2),null==e&&(e=32),o=[],r=-.5/(t/i._SIGMA_8BIT*(n/i._SIGMA_8BIT)),h=a=c=1-n;n>a;h=a+=1)for(s=l=p=1-t;t>l;s=l+=1)o.push(Math.exp((s*s+h*h)*r));i.__super__.constructor.call(this,t,n,o,1,!1),u=e/255*Math.sqrt(195075)/i._SIGMA_8BIT,this._gaussColorCoeff=-.5/(u*u)}return D(i,t),i._SIGMA_8BIT=2.04045,i.prototype._runKernel=function(t,i,n,e,r,o){var s,h,u,a,l,c,p,f,_,d,y,x,m,g,v,w,M,E;for(u=this._getPixel(i,n,e,r,o),y=0,p=0,d=m=v=1-this._radiusY,w=this._radiusY;w>m;d=m+=1)for(h=e+d,_=g=M=1-this._radiusX,E=this._radiusX;E>g;_=g+=1)s=n+_,f=this._getPixel(i,s,h,r,o),c=f[0]-u[0],l=f[1]-u[1],a=f[2]-u[2],x=this._kernel[p]*Math.exp((c*c+l*l+a*a)*this._gaussColorCoeff),y+=x,t[0]+=f[0]*x,t[1]+=f[1]*x,t[2]+=f[2]*x,p++;return t[0]/=y,t[1]/=y,t[2]/=y},i}(g),i=function(t){function i(t,n,e,r){var o,s;if(null==t&&(t=320),null==n&&(n=320),null==e&&(e=0),null==r&&(r=0),i.__super__.constructor.call(this),t instanceof i)s=t,t=s.width(),n=s.height();else switch(t.nodeName){case"CANVAS":o=t,t=o.width,n=o.height;break;case"IMG":s=t,t=s.width,n=s.height}if(t=+t,n=+n,0===t||0===n)throw new TypeError("Can't construct with 0 size");null!=o?this.canvas=o:(this.canvas=document.createElement("canvas"),this.width(t),this.height(n)),this._context=this.canvas.getContext("2d"),this._context.strokeStyle="rgba(0,0,0,0)",0!==r&&(this.beginFill(e,r),this.drawRect(0,0,t,n),this.endFill()),null!=s&&this.draw(s)}return D(i,t),i._PI_2=2*Math.PI,i._PI_OVER_2=Math.PI/2,i._ELLIPSE_CUBIC_BEZIER_HANDLE=4*(Math.SQRT2-1)/3,i.prototype.clone=function(){var t;return t=new i(this.width(),this.height()),t.draw(this),t},i.prototype.width=function(t){return null==t?this.canvas.width:this.canvas.width=t},i.prototype.height=function(t){return null==t?this.canvas.height:this.canvas.height=t},i.prototype.encodeAsPNG=function(){return s.fromDataURL(this.encodeAsBase64PNG())},i.prototype.encodeAsJPG=function(t){return null==t&&(t=.8),s.fromDataURL(this.encodeAsBase64JPG(t))},i.prototype.encodeAsBase64PNG=function(t){var i;return null==t&&(t=!1),i=this.canvas.toDataURL("image/png"),t?i.split(",")[1]:i},i.prototype.encodeAsBase64JPG=function(t,i){var n;return null==t&&(t=.8),null==i&&(i=!1),n=this.canvas.toDataURL("image/jpeg",t),i?n.split(",")[1]:n},i.prototype.clear=function(){return this.canvas.width=this.canvas.width,this._context.fillStyle=this._context.strokeStyle="rgba(0,0,0,0)"},i.prototype.draw=function(t,r){var o,s;return t instanceof i&&(t.blendMode!==e.NORMAL&&(s=t.getPixels(),o=this.getPixels(),o=n.scan(t.blendMode,s,o)),t=t.canvas),null!=r&&this._context.setTransform(r.m11,r.m12,r.m21,r.m22,r.tx,r.ty),null!=o?this._context.putImageData(o,0,0):this._context.drawImage(t,0,0),this._context.setTransform(1,0,0,1,0,0)},i.prototype.getPixels=function(t){return null==t&&(t=new I(0,0,this.width(),this.height())),this._context.getImageData(t.x,t.y,t.width,t.height)},i.prototype.setPixels=function(t){return this._context.putImageData(t,0,0)},i.prototype.getPixel32=function(t,i){var n,e,r,o,s;return s=this._context.getImageData(t,i,1,1).data,o=s[0],r=s[1],e=s[2],n=s[3],n<<24|o<<16|r<<8|e},i.prototype.getPixel=function(t,i){var n,e,r,o;return o=this._context.getImageData(t,i,1,1).data,r=o[0],e=o[1],n=o[2],r<<16|e<<8|n},i.prototype.filter=function(){var t,i,n,e,r;for(i=arguments.length>=1?C.call(arguments,0):[],n=this.getPixels(),e=0,r=i.length;r>e;e++)t=i[e],t.run(n);return this.setPixels(n)},i.prototype.lineStyle=function(t,i,n,e,r,o){return null==t&&(t=1),null==i&&(i=0),null==n&&(n=1),null==e&&(e=h.NONE),null==r&&(r=m.BEVEL),null==o&&(o=10),this._context.lineWidth=t,this._context.strokeStyle=u.toCSSString(i,n),this._context.lineCaps=e,this._context.lineJoin=r,this._context.miterLimit=o},i.prototype.beginFill=function(t,i){return null==t&&(t=0),null==i&&(i=1),this._context.fillStyle=u.toCSSString(t,i)},i.prototype.endFill=function(){return this._context.closePath(),this._context.fillStyle="rgba(0,0,0,0)"},i.prototype.moveTo=function(t,i){return this._context.moveTo(t,i)},i.prototype.lineTo=function(t,i){return this._context.lineTo(t,i)},i.prototype.drawRect=function(t,i,n,e){return this._context.beginPath(),this._context.rect(t,i,n,e),this._context.closePath(),this._render()},i.prototype.drawCircle=function(t,n,e,r){return this._context.beginPath(),this._context.moveTo(t+e,n),this._context.arc(t,n,e,0,i._PI_2,0>r),this._context.closePath(),this._render()},i.prototype.drawEllipse=function(t,n,e,r,o){var s,h;return null==o&&(o=0),e/=2,r/=2,t+=e,n+=r,h=e*i._ELLIPSE_CUBIC_BEZIER_HANDLE,s=r*i._ELLIPSE_CUBIC_BEZIER_HANDLE,this.drawPath([y.MOVE_TO,y.CUBIC_CURVE_TO,y.CUBIC_CURVE_TO,y.CUBIC_CURVE_TO,y.CUBIC_CURVE_TO],[t+e,n,t+e,n+s,t+h,n+r,t,n+r,t-h,n+r,t-e,n+s,t-e,n,t-e,n-s,t-h,n-r,t,n-r,t+h,n-r,t+e,n-s,t+e,n],o)},i.prototype.curveTo=function(t,i,n,e){return this._context.quadraticCurveTo(t,i,n,e)},i.prototype.cubicCurveTo=function(t,i,n,e,r,o){return this._context.bezierCurveTo(t,i,n,e,r,o)},i.prototype.drawPath=function(t,i,n){var e,r,o,s;for(null==n&&(n=0),this._context.beginPath(),r=0,o=0,s=t.length;s>o;o++)switch(e=t[o]){case y.MOVE_TO:this._context.moveTo(i[r++],i[r++]);break;case y.LINE_TO:this._context.lineTo(i[r++],i[r++]);break;case y.CURVE_TO:this._context.quadraticCurveTo(i[r++],i[r++],i[r++],i[r++]);break;case y.CUBIC_CURVE_TO:this._context.bezierCurveTo(i[r++],i[r++],i[r++],i[r++],i[r++],i[r++])}return this._context.closePath(),this._render()},i.prototype.drawRoundRect=function(t,i,n,e,r,o,s){return null==o&&(o=r),null==s&&(s=0),this.drawPath([0,1,2,1,2,1,2,1,2],[t+r,i,t+n-r,i,t+n,i,t+n,i+o,t+n,i+e-o,t+n,i+e,t+n-r,i+e,t+r,i+e,t,i+e,t,i+e-o,t,i+o,t,i,t+r,i],s)},i.prototype.drawRegularPolygon=function(t,n,e,r,o){var s,h,u,a,l,c;for(null==r&&(r=3),null==o&&(o=0),s=[],h=[],l=i._PI_2/r,u=c=0;r>=0?r>=c:c>=r;u=r>=0?++c:--c)s.push(0===u?0:1),a=-i._PI_OVER_2+l*u,h.push(t+e*Math.cos(a),n+e*Math.sin(a));return this.drawPath(s,h,o)},i.prototype.drawRegularStar=function(t,i,n,e,r){var o;return null==e&&(e=5),null==r&&(r=0),o=Math.cos(Math.PI/e),this.drawStar(t,i,n,n*(2*o-1/o),e,r)},i.prototype.drawStar=function(t,n,e,r,o,s){var h,u,a,l,c,p,f,_;for(null==o&&(o=5),null==s&&(s=0),h=[],u=[],p=Math.PI/o,a=f=0,_=2*o;_>=f;a=f+=1)h.push(0===a?0:1),l=0===(1&a)?e:r,c=-i._PI_OVER_2+p*a,u.push(t+l*Math.cos(c),n+l*Math.sin(c));return this.drawPath(h,u,s)},i.prototype.drawLine=function(t){var i,n,e,r,o;for(i=[],n=[],r=0,o=t.length;o>r;r++)e=t[r],i.push(y.LINE_TO),n.push(e.x,e.y);return this.drawPath(i,n)},i.prototype.drawSpline=function(t,i){var n,e,r,o,s,h,u,a,l,c,p,f,_,d;for(null==i&&(i=10),e=[],r=[],n=t[0].equals(t[t.length-1]),f=t.length,u=n?f:f-1,s=i,h=_=0;u>_;h=_+=1)for(a=t[this._normalizeIndex(h-1,f,n)],l=t[this._normalizeIndex(h,f,n)],c=t[this._normalizeIndex(h+1,f,n)],p=t[this._normalizeIndex(h+2,f,n)],h===u-1&&(s=n?1:i+1),o=d=0;s>d;o=d+=1)e.push(y.LINE_TO),r.push(this._interpolateSpline(a.x,l.x,c.x,p.x,o/i),this._interpolateSpline(a.y,l.y,c.y,p.y,o/i));return e[0]=y.MOVE_TO,this.drawPath(e,r)},i.prototype._normalizeIndex=function(t,i,n){return n?0>t?i-1+t:t>=i?1+(t-i):t:0>t?0:t>=i?i-1:t},i.prototype._interpolateSpline=function(t,i,n,e,r){var o,s;return o=r*r,s=o*r,.5*(-t+3*i-3*n+e)*s+.5*(2*t-5*i+4*n-e)*o+.5*(-t+n)*r+i},i.prototype._render=function(){return this._context.fill(),this._context.stroke()},i}(c),r=function(t){function i(t,n,e){var r,o,s,h;for(h=2*t-1,s=h*h,r=1/s,o=[];s--;)o.push(r);console.log(t,n,o),i.__super__.constructor.call(this,t,n,o,e,!0)}return D(i,t),i}(g),L={sc:{ript:{color:{Color:u,HSV:x,RGB:b},display:{CapsStyle:h,DisplayObject:c,GraphicsPathCommand:y,JointStyle:m,BlendMode:e,Bitmap:i},event:{EventEmitter:f,Event:p},utils:{ByteArray:s,NumberUtil:w,Type:R},serializer:{QueryString:E},filter:{Filter:_,ThresholdFilter:P,KernelFilter:g,GaussianBlurFilter:d,ColorMatrixFilter:a,BilateralFilter:t,BlurFilter:r},path:B,geom:{Rectangle:I,Point:M,Matrix:v},deferred:{DLoader:l},ui:{Button:o}}},tc:{ript:{display:{Blend:n}}}};for(T in L)O=L[T],window[T]=O}).call(this);